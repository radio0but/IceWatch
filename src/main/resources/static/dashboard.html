<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org" style="height: 100%;">
<head>
  <meta charset="UTF-8" />
  <title>Tableau de bord - Administration Radio</title>
  <link rel="icon" type="image/png" href="${favicon}">
  <link rel="stylesheet" href="/css/dashboard/index.css">
  <th:block th:if="${custom.css}">
  <style th:utext="${custom.css}"></style>
</th:block>
</head>
<body style="height: 100%;">


  <!-- === Topbar (fixe) === -->
  <header class="topbar">
  <div class="topbar-left">
    <button id="sidebar-toggle">â‰¡</button>
    <span class="radio-title">${radio.title}</span>
    <span id="clock" style="margin-left: auto; font-weight: bold;"></span>
    <span id="stream-status" style="margin-left: 1rem;">ğŸ”„ Chargementâ€¦</span>
    
  </div>
    <div class="topbar-center">
      <h1>Tableau de bord - Administration Radio</h1>
    </div>
    <div class="topbar-right">
      <button onclick="location.href='/index'">ğŸ”™ Revenir Ã  la radio</button>
    </div>
  </header>

<!-- === Layout principal === -->
<div class="dashboard-layout">
  <!-- === Sidebar === -->
  <aside class="sidebar">

    <nav class="sidebar-nav">
      <!-- <button data-tab="status" data-label="ğŸ“ˆ">ğŸ“ˆ Ã‰tat</button> -->
      <button data-tab="slots" data-label="ğŸ“…">ğŸ“… CrÃ©neaux</button>
      <button data-tab="rss" data-label="ğŸ—ï¸">ğŸ—ï¸ Journal</button>
      <button data-tab="users" data-label="ğŸ‘¥">ğŸ‘¥ Utilisateurs</button>
      <button data-tab="appearance" data-label="ğŸ¨">ğŸ¨ Personnalisation</button>
      <button data-tab="maintenance" data-label="ğŸ› ï¸">ğŸ› ï¸ Maintenance</button>

    </nav>
  </aside>

  <!-- === Contenu principal === -->
  <div class="main-area">
    <!-- === Contenu dynamique injectÃ© ici === -->
    <main id="main-content">
      <!-- Toutes les sections existantes ici -->
      <!-- <div id="tab-status" class="tab-content">ğŸ“ˆ (Section Ã©tat â€” Ã  crÃ©er)</div> -->
<div id="tab-slots" class="tab-content">
  <h2>Planning des crÃ©neaux</h2>

  <p style="margin-top: -0.5rem; max-width: 800px; line-height: 1.6;">
    Le planning ci-dessous affiche les contenus prÃ©vus pour chaque heure, que ce soit pour la radio ğŸ“» ou la tÃ©lÃ©vision ğŸ“º.
    Les crÃ©neaux peuvent Ãªtre vides ğŸ”µ, automatiques âœ… (lecture planifiÃ©e) ou en direct ğŸŸ¡.
    <br><br>
    Les fichiers doivent Ãªtre placÃ©s dans les dossiers locaux accessibles uniquement depuis les ordinateurs du <strong>studio</strong> ou de la <strong>salle Muse</strong>.
  </p>

  <ul style="margin-top: 0; margin-bottom: 1.5rem; line-height: 1.5;">
    <li>ğŸ§ <code>~/radioemissions/&lt;jour&gt;/&lt;heure&gt;/</code></li>
    <li>ğŸ“º <code>~/owncastvideos/&lt;N&gt;&lt;Jour&gt;/&lt;heure&gt;/</code> (ex. <code>4Mercredi/14</code>)</li>
  </ul>
<div class="legend">
  <span>ğŸ“» = Radio</span>
  <span>ğŸ“º = TÃ©lÃ©vision</span>
  <span class="status-live" style="color: gold; font-weight: bold;">ğŸŸ¡ En direct</span>
  <span class="status-auto" style="color: limegreen; font-weight: bold;">âœ…  Automatique</span>
  <span class="status-empty" style="color: dodgerblue; font-weight: bold;">ğŸ”µ Vide</span>
</div>

  <div class="schedule-wrapper">
    <div id="schedule-grid">
      <!-- La grille sera gÃ©nÃ©rÃ©e en JS -->
    </div>
    <div id="slot-details" style="display: none;"></div>

  </div>
</div>

      <div id="tab-rss" class="tab-content">
  <h2>ğŸ—ï¸ Journal Ã©tudiant (via flux RSS)</h2>

  <p>Ce module permet dâ€™afficher automatiquement les derniers articles dâ€™un journal Ã©tudiant externe (ex: WordPress) dans la page dâ€™accueil.</p>

  <label for="rss-url">ğŸ”— URL du flux RSS :</label>
  <input type="text" id="rss-url" placeholder="https://exemple.com/feed" />

  <div style="display: flex; gap: 1rem; margin-top: 1rem;">
    <button onclick="testRSS()">ğŸ” Tester le lien</button>
    <button onclick="saveRSS()">ğŸ’¾ Enregistrer</button>
    <div style="margin-top: 1rem;">
      <label>
        <input type="checkbox" id="rss-show-images" />
        ğŸ–¼ï¸ Afficher les images des articles RSS
      </label>
    </div>
    <span id="rss-status" style="align-self: center;"></span>
  </div>
</div>

      <div id="tab-users" class="tab-content">
  <h2>Gestion des utilisateurs</h2>
  <table>
    <thead>
      <tr>
        <th>Nom d'utilisateur</th>
        <th>RÃ´les</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody id="user-list">
      <!-- Rempli dynamiquement -->
    </tbody>
  </table>

  <form action="/admin/create" method="post">
    <h3>CrÃ©er un nouvel utilisateur</h3>
    <input type="text" name="username" placeholder="Nom d'utilisateur" required />
    <input type="password" name="password" placeholder="Mot de passe" required />
    <select name="role">
      <option value="USER">Utilisateur</option>
      <option value="ADMIN">Administrateur</option>
    </select>
    <button type="submit">CrÃ©er</button>
  </form>
</div>

      <div id="tab-appearance" class="tab-content">
  <h2>ğŸ§‘â€ğŸ¨ Personnalisation de lâ€™apparence</h2>

  <p>
    <strong>Instructions :</strong><br>
    Toutes les options de personnalisation peuvent Ãªtre modifiÃ©es depuis cette interface.
    <ul style="margin-top:0;">
      <li><strong>1.</strong> Cliquez sur <strong>â™»ï¸ RÃ©initialiser Apparence</strong> pour repartir dâ€™une base propre, si nÃ©cessaire.</li>
      <li><strong>2.</strong> Modifiez les paramÃ¨tres dans la zone ci-dessous.</li>
      <li><strong>3.</strong> Cliquez sur <strong>ğŸ“ Enregistrer</strong> pour appliquer vos modifications.</li>
      <li><strong>4.</strong> Rechargez la page si vous souhaitez voir les effets visuels dans le tableau de bord.</li>
    </ul>
    Les modifications sont appliquÃ©es immÃ©diatement aprÃ¨s lâ€™enregistrement.
  </p>

  <textarea id="properties-editor" rows="15" style="width:100%;"></textarea>
<!-- Boutons regroupÃ©s -->
<div style="display: flex; flex-wrap: wrap; gap: 2rem; margin-top: 1rem;">

  <!-- Box 1 : Calepin / Import / Export -->
  <div style="background-color: rgba(0, 0, 0, 0.5); padding: 1rem; border-radius: 8px; display: flex; gap: 1rem; flex-wrap: wrap;">
    <button id="append-to-notes">ğŸ“ Ajouter au calepin</button>
    <button id="export-properties">ğŸ“¤ Exporter (.look)</button>
   <input type="file" id="import-properties" accept=".look" style="display: none;">
    <button id="import-button">ğŸ“¥ Importer (.look)</button>

  </div>

  <!-- Box 2 : Enregistrer / RÃ©initialiser -->
  <div style="background-color: rgba(0, 0, 0, 0.5); padding: 1rem; border-radius: 8px; display: flex; gap: 1rem;">
    <button id="save-button">ğŸ’¾ Appliquer</button>
    <button id="reset-button" class="danger">â™»ï¸ RÃ©initialiser Apparence</button>
  </div>

</div>


  <h3>ğŸ“ Calepin de notes</h3>
  <p style="margin-top: -0.5rem;">
    Utilisez cet espace pour conserver des notes sur vos thÃ¨mes, configurations ou commentaires techniques. Les modifications sont sauvegardÃ©es automatiquement.
  </p>
  <textarea id="appearance-notes" rows="8" style="width:100%; resize:vertical; font-family:monospace;" placeholder="Vos notes iciâ€¦">${notes}</textarea>
</div>

      <div id="tab-maintenance" class="tab-content">
  <h2>RedÃ©marrer IceWatch & Schedulers</h2>
  <p>Utilisez ces boutons pour redÃ©marrer les services.</p>

  <button id="restart-button" class="danger">
    ğŸš¨ RedÃ©marrer IceWatch <span id="status-restart"></span>
  </button>

  <div style="margin-top: 1rem;">
    <button id="restart-video-button" class="danger">
      ğŸ¬ RedÃ©marrer VidÃ©o Scheduler <span id="status-restart-video"></span>
    </button>
    <button id="restart-radio-button" class="danger">
      ğŸ“» RedÃ©marrer Radio Scheduler <span id="status-restart-radio"></span>
    </button>

    <h3 style="margin-top: 2rem;">ğŸ¬ Logs VidÃ©o Scheduler</h3>
    <button id="refresh-log-video">
      ğŸ”„ Actualiser <span id="status-log-video"></span>
    </button>
    <textarea id="log-video" rows="12" readonly style="width:100%; margin-top:0.5rem;"></textarea>
  </div>

  <div style="margin-top: 0.5rem;">
    <h3 style="margin-top: 2rem;">ğŸ“» Logs Radio Scheduler</h3>
    <button id="refresh-log-radio">
      ğŸ”„ Actualiser <span id="status-log-radio"></span>
    </button>
    <textarea id="log-radio" rows="12" readonly style="width:100%; margin-top:0.5rem;"></textarea>
  </div>


    </main>
    </div>
  </div>
</div>
<!-- === Onglet de prÃ©visualisation du portail === -->
<div id="preview-toggle">ğŸ‘€</div>

<div id="preview-panel">
  <div id="preview-resize-handle"></div> <!-- â† poignÃ©e ici -->


  <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem 1rem; background: #222; border-bottom: 1px solid var(--border);">
    <span style="color: var(--accent); font-weight: bold;">ğŸ” PrÃ©visualisation du portail</span>
    <div id="preview-test-toolbar" style="background:#111; padding: 0.5rem 1rem; border-bottom: 1px solid var(--border); display:flex; gap:1rem; align-items: center;">
      <span style="color:#f1f1f1;">ğŸ§ª Test interface :</span>
      <label style="color:white;"><input type="checkbox" id="toggle-preview-rss" checked> ğŸ—ï¸ Journal</label>
      <label style="color:white;"><input type="checkbox" id="toggle-preview-logout" checked> ğŸ”“ DÃ©connexion</label>
      <label style="color:white;"><input type="checkbox" id="toggle-preview-description" checked> ğŸ“ Descriptions</label>
      <label style="color:white;"><input type="checkbox" id="toggle-preview-html" checked> ğŸ§© Contenu HTML</label>

    </div>
    <div>
      <button id="preview-refresh">ğŸ”</button>
      <button id="preview-close">âŒ</button>
    </div>
  </div>
  <iframe id="preview-iframe" src="/index"></iframe>
</div>
<script type="module" src="/js/dashboard/index.js"></script>
</body>
</html>
