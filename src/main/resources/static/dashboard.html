<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="fr">
<head>
    <link rel="icon" type="image/png" href="${favicon}">
    <meta charset="UTF-8">
    <title>Tableau de bord - Administration Radio</title>
    <link rel="stylesheet" href="/css/dashboard/index.css">
    <style>${custom.css}</style>
</head>
<body>
<h1>Tableau de bord - Administration Radio</h1>

<div class="tabs">
    <button class="tab-button active" data-tab="slots">📅 Créneaux</button>
    <button class="tab-button" data-tab="rss">🗞️ Journal</button>
    <button class="tab-button" data-tab="users">👥 Utilisateurs</button>
    <button class="tab-button" data-tab="appearance">🧑‍🎨 Personnalisation</button>
    <button class="tab-button" data-tab="maintenance">🛠️ Maintenance</button>


</div>

<!-- Onglet Journal -->
<div id="tab-rss" class="tab-content">
  <h2>🗞️ Journal étudiant (via flux RSS)</h2>

  <p>Ce module permet d’afficher automatiquement les derniers articles d’un journal étudiant externe (ex: WordPress) dans la page d’accueil.</p>

  <label for="rss-url">🔗 URL du flux RSS :</label>
  <input type="text" id="rss-url" placeholder="https://exemple.com/feed" />

  <div style="display: flex; gap: 1rem; margin-top: 1rem;">
    <button onclick="testRSS()">🔍 Tester le lien</button>
    <button onclick="saveRSS()">💾 Enregistrer</button>
    <div style="margin-top: 1rem;">
  <label>
    <input type="checkbox" id="rss-show-images" />
    🖼️ Afficher les images des articles RSS
  </label>
</div>
    <span id="rss-status" style="align-self: center;"></span>
  </div>
</div>


<!-- Onglet Utilisateurs -->
<div id="tab-users" class="tab-content active">
    <h2>Gestion des utilisateurs</h2>
    <table>
        <thead>
            <tr>
                <th>Nom d'utilisateur</th>
                <th>Rôles</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody id="user-list">
            <!-- Rempli dynamiquement -->
        </tbody>
    </table>

    <form action="/admin/create" method="post">
        <h3>Créer un nouvel utilisateur</h3>
        <input type="text" name="username" placeholder="Nom d'utilisateur" required />
        <input type="password" name="password" placeholder="Mot de passe" required />
        <select name="role">
            <option value="USER">Utilisateur</option>
            <option value="ADMIN">Administrateur</option>
        </select>
        <button type="submit">Créer</button>
    </form>
</div>

<!-- Onglet Paramètres -->
<div id="tab-appearance" class="tab-content">
  <h2>🧑‍🎨 Personnalisation de l’apparence</h2>

  <p>
    <strong>Instructions :</strong><br>
    Toutes les options de personnalisation peuvent être modifiées depuis cette interface.
    <ul style="margin-top:0;">
      <li><strong>1.</strong> Cliquez sur <strong>♻️ Réinitialiser Apparence</strong> pour repartir d’une base propre, si nécessaire.</li>
      <li><strong>2.</strong> Modifiez les paramètres dans la zone ci-dessous.</li>
      <li><strong>3.</strong> Cliquez sur <strong>📎 Enregistrer</strong> pour appliquer vos modifications.</li>
      <li><strong>4.</strong> Rechargez la page si vous souhaitez voir les effets visuels dans le tableau de bord.</li>
    </ul>
    Les modifications sont appliquées immédiatement après l’enregistrement.
  </p>

  <textarea id="properties-editor" rows="15" style="width:100%;"></textarea>
  <button id="save-button">📎 Enregistrer</button>
  <button id="reset-button" class="danger">♻️ Réinitialiser Apparence</button>

  <h3>📝 Calepin de notes</h3>
  <p style="margin-top: -0.5rem;">
    Utilisez cet espace pour conserver des notes sur vos thèmes, configurations ou commentaires techniques. Les modifications sont sauvegardées automatiquement.
  </p>
  <textarea id="appearance-notes" rows="8" style="width:100%; resize:vertical; font-family:monospace;" placeholder="Vos notes ici…">\${notes}</textarea>
</div>
<!-- Onglet Créneaux -->
<!-- Onglet Créneaux -->
<div id="tab-slots" class="tab-content">
    <h2>Planning des créneaux</h2>
    <div class="legend">
        <span>📻 = Radio</span>
        <span>📺 = Vidéo</span>
        <span class="status-live">🔴 En direct</span>
        <span class="status-auto">⚙️ Automatique</span>
        <span class="status-empty">⚪ Vide</span>
    </div>
    <div class="schedule-wrapper">
  <div id="schedule-grid">
      <!-- La grille sera générée en JS -->
  </div>
</div>
</div>

<!-- Onglet Redémarrage -->
<div id="tab-maintenance" class="tab-content">
  <h2>Redémarrer IceWatch & Schedulers</h2>
  <p>Utilisez ces boutons pour redémarrer les services.</p>

  <button id="restart-button" class="danger">
    🚨 Redémarrer IceWatch <span id="status-restart"></span>
  </button>

  <div style="margin-top: 1rem;">
    <button id="restart-video-button" class="danger">
      🎬 Redémarrer Vidéo Scheduler <span id="status-restart-video"></span>
    </button>
    <button id="restart-radio-button" class="danger">
      📻 Redémarrer Radio Scheduler <span id="status-restart-radio"></span>
    </button>

    <h3 style="margin-top: 2rem;">🎬 Logs Vidéo Scheduler</h3>
    <button id="refresh-log-video">
      🔄 Actualiser <span id="status-log-video"></span>
    </button>
    <textarea id="log-video" rows="12" readonly style="width:100%; margin-top:0.5rem;"></textarea>
  </div>

  <div style="margin-top: 0.5rem;">
    <h3 style="margin-top: 2rem;">📻 Logs Radio Scheduler</h3>
    <button id="refresh-log-radio">
      🔄 Actualiser <span id="status-log-radio"></span>
    </button>
    <textarea id="log-radio" rows="12" readonly style="width:100%; margin-top:0.5rem;"></textarea>
  </div>
</div>



<div id="Home" style="margin-top: 20px; text-align: center;">
  <button class="tab-button" onclick="location.href='/index'">📻Revenir à la radio</button>
</div>

<script type="module" src="/js/dashboard/index.js"></script>
</body>
</html>
